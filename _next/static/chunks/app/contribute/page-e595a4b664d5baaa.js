(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[656],{19946:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var i=r(12115);let n=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),a=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim()};var s={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let l=(0,i.forwardRef)((e,t)=>{let{color:r="currentColor",size:n=24,strokeWidth:l=2,absoluteStrokeWidth:o,className:c="",children:d,iconNode:u,...m}=e;return(0,i.createElement)("svg",{ref:t,...s,width:n,height:n,stroke:r,strokeWidth:o?24*Number(l)/Number(n):l,className:a("lucide",c),...m},[...u.map(e=>{let[t,r]=e;return(0,i.createElement)(t,r)}),...Array.isArray(d)?d:[d]])}),o=(e,t)=>{let r=(0,i.forwardRef)((r,s)=>{let{className:o,...c}=r;return(0,i.createElement)(l,{ref:s,iconNode:t,className:a("lucide-".concat(n(e)),o),...c})});return r.displayName="".concat(e),r}},39464:(e,t,r)=>{"use strict";r.d(t,{Y:()=>a});var i=r(95155),n=r(23968);function a(){return(0,i.jsx)("header",{className:"sticky top-0 z-50 w-full border-b bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60",children:(0,i.jsxs)("div",{className:"container flex h-16 items-center",children:[(0,i.jsx)("div",{className:"mr-4 flex items-center space-x-2",children:(0,i.jsx)("h1",{className:"text-xl font-bold",children:"Takaful Life"})}),(0,i.jsx)(n.MainNav,{})]})})}},46565:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>z});var i,n,a=r(95155),s=r(12115),l=r(39464),o=r(88482),c=r(89852),d=r(82714),u=r(97168),m=r(49026),f=r(85339),p=r(11392),g=r(29103),x=r(23570),b=r(14503),h=r(20558),v=r(12340),y=r(46416),w=r(29561),N=r(29359),j=r(9669);!function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Mint=1]="Mint",e[e.Account=2]="Account"}(i||(i={}));let k=(0,y.w3)([(0,y.u8)("m"),(0,y.u8)("n"),(0,w.lc)("isInitialized"),(0,w.jE)("signer1"),(0,w.jE)("signer2"),(0,w.jE)("signer3"),(0,w.jE)("signer4"),(0,w.jE)("signer5"),(0,w.jE)("signer6"),(0,w.jE)("signer7"),(0,w.jE)("signer8"),(0,w.jE)("signer9"),(0,w.jE)("signer10"),(0,w.jE)("signer11")]).span;var E=r(44134).Buffer;!function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initialized=1]="Initialized",e[e.Frozen=2]="Frozen"}(n||(n={}));let A=(0,y.w3)([(0,w.jE)("mint"),(0,w.jE)("owner"),(0,w._l)("amount"),(0,y.DH)("delegateOption"),(0,w.jE)("delegate"),(0,y.u8)("state"),(0,y.DH)("isNativeOption"),(0,w._l)("isNative"),(0,w._l)("delegatedAmount"),(0,y.DH)("closeAuthorityOption"),(0,w.jE)("closeAuthority")]),S=A.span;async function C(e,t,r,a=N.x5){let s=await e.getAccountInfo(t,r);return function(e,t,r=N.x5){if(!t)throw new j.kD;if(!t.owner.equals(r))throw new j.bY;if(t.data.length<S)throw new j.vd;let a=A.decode(t.data.slice(0,S)),s=E.alloc(0);if(t.data.length>S){if(t.data.length===k)throw new j.vd;if(t.data[S]!=i.Account)throw new j.ce;s=t.data.slice(S+1)}return{address:e,mint:a.mint,owner:a.owner,amount:a.amount,delegate:a.delegateOption?a.delegate:null,delegatedAmount:a.delegatedAmount,isInitialized:a.state!==n.Uninitialized,isFrozen:a.state===n.Frozen,isNative:!!a.isNativeOption,rentExemptReserve:a.isNativeOption?a.isNative:null,closeAuthority:a.closeAuthorityOption?a.closeAuthority:null,tlvData:s}}(t,s,a)}var P=r(44134).Buffer;function R(e,t,r,i,n=N.x5,a=N.EK){return function(e,t,r,i,n,a=N.x5,s=N.EK){let l=[{pubkey:e,isSigner:!0,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!1},{pubkey:i,isSigner:!1,isWritable:!1},{pubkey:x.SystemProgram.programId,isSigner:!1,isWritable:!1},{pubkey:a,isSigner:!1,isWritable:!1}];return new x.TransactionInstruction({keys:l,programId:s,data:n})}(e,t,r,i,P.alloc(0),n,a)}var O=r(53999),L=r(6874),T=r.n(L),I=r(44134).Buffer;function z(){let e=(0,p.v)(),{program:t,poolPDA:r,findParticipantPDA:i,provider:n}=(0,g.w)(),{toast:y}=(0,b.dj)(),[w,j]=(0,s.useState)(""),[k,E]=(0,s.useState)(null),[A,S]=(0,s.useState)(!1),[P,L]=(0,s.useState)(!0),[z,F]=(0,s.useState)(null),[K,W]=(0,s.useState)(null);(0,s.useEffect)(()=>{(async()=>{if(!e.publicKey||!t){L(!1);return}try{L(!0),F(null);let[r]=await i(e.publicKey);if(!await t.provider.connection.getAccountInfo(r)){F("You are not registered as a participant. Please register first."),L(!1);return}let n=await t.account.participant.fetch(r);E(n),L(!1)}catch(e){console.error("Error fetching participant data:",e),F("You are not registered as a participant. Please register first."),L(!1)}})()},[e.publicKey,t]);let D=async a=>{if(a.preventDefault(),W(null),!w||isNaN(Number(w))||0>=Number(w)){y({title:"Invalid amount",description:"Please enter a valid contribution amount",variant:"destructive"});return}if(!e.publicKey||!t||!r||!k||!n){y({title:"Wallet not connected",description:"Please connect your wallet to contribute",variant:"destructive"});return}try{S(!0);let a=new h.BN(Number(w)*x.LAMPORTS_PER_SOL),[s]=await i(e.publicKey),l=Math.floor(Date.now()/1e3),[o]=await x.PublicKey.findProgramAddress([I.from("contribution"),new h.BN(k.id).toArrayLike(I,"le",8),new h.BN(l).toArrayLike(I,"le",8)],t.programId),c=new x.PublicKey("So11111111111111111111111111111111111111112"),d=await (0,v.Ob)(c,e.publicKey),u=await (0,v.Ob)(c,r,!0),m=new x.Transaction;try{await C(n.connection,d)}catch(t){m.add(R(e.publicKey,d,e.publicKey,c))}try{await C(n.connection,u)}catch(t){m.add(R(e.publicKey,u,r,c))}if(m.instructions.length>0)try{y({title:"Setting up token accounts",description:"Please approve the transaction to set up required token accounts"});let t=await e.sendTransaction(m,n.connection);await n.connection.confirmTransaction(t,"confirmed"),y({title:"Token accounts created",description:"Now processing your contribution"})}catch(e){console.error("Error setting up token accounts:",e),W("Failed to set up token accounts. Please try again."),S(!1);return}y({title:"Processing contribution",description:"Please approve the transaction to make your contribution"}),await t.methods.makeContribution(a).accounts({authority:e.publicKey,pool:r,participant:s,contribution:o,contributorTokenAccount:d,poolTokenAccount:u,tokenProgram:N.x5,systemProgram:x.SystemProgram.programId}).rpc(),y({title:"Contribution successful",description:"You have contributed ".concat(w," SOL to the Takaful pool")}),j("")}catch(e){var s,l;console.error("Error making contribution:",e),(null===(s=e.message)||void 0===s?void 0:s.includes("User rejected"))?W("Transaction was rejected. Please try again and approve the transaction in your wallet."):(null===(l=e.message)||void 0===l?void 0:l.includes("insufficient funds"))?W("Insufficient funds for this transaction. Please make sure you have enough SOL."):W("Failed to make contribution: ".concat(e.message||"Unknown error")),y({title:"Contribution failed",description:"Failed to make contribution. Please check the error details.",variant:"destructive"})}finally{S(!1)}};return e.connected?(0,a.jsxs)("div",{className:"flex min-h-screen flex-col",children:[(0,a.jsx)(l.Y,{}),(0,a.jsx)("main",{className:"flex-1 container py-12",children:(0,a.jsx)("div",{className:"max-w-md mx-auto",children:(0,a.jsxs)(o.Zp,{children:[(0,a.jsxs)(o.aR,{children:[(0,a.jsx)(o.ZB,{children:"Make a Contribution"}),(0,a.jsx)(o.BT,{children:"Contribute to the Takaful Life pool (Tabarru')"})]}),P?(0,a.jsx)(o.Wu,{className:"flex justify-center py-6",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):z?(0,a.jsx)(o.Wu,{children:(0,a.jsxs)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[(0,a.jsx)("p",{className:"text-yellow-700",children:z}),(0,a.jsx)("div",{className:"mt-4",children:(0,a.jsx)(u.$,{asChild:!0,children:(0,a.jsx)(T(),{href:"/register",children:"Register Now"})})})]})}):k?(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)(o.Wu,{className:"space-y-4",children:[K&&(0,a.jsxs)(m.Fc,{variant:"destructive",children:[(0,a.jsx)(f.A,{className:"h-4 w-4"}),(0,a.jsx)(m.XL,{children:"Error"}),(0,a.jsx)(m.TN,{children:K})]}),(0,a.jsxs)("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[(0,a.jsx)("h3",{className:"font-medium text-green-800",children:"Participant Information"}),(0,a.jsxs)("p",{className:"mt-1 text-green-700",children:["ID: ",k.id.toString()]}),(0,a.jsxs)("p",{className:"mt-1 text-green-700",children:["Name: ",k.name]}),k.lastContributionDate.toNumber()>0&&(0,a.jsxs)("p",{className:"mt-1 text-green-700",children:["Last Contribution: ",(0,O.Y)(1e3*k.lastContributionDate.toNumber())]})]}),(0,a.jsxs)("form",{onSubmit:D,children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(d.J,{htmlFor:"amount",children:"Contribution Amount (SOL)"}),(0,a.jsx)(c.p,{id:"amount",type:"number",min:"0.01",step:"0.01",value:w,onChange:e=>j(e.target.value),placeholder:"Enter amount in SOL"})]}),(0,a.jsx)(u.$,{type:"submit",className:"w-full mt-4",disabled:A,children:A?"Processing...":"Make Contribution"})]})]})}):(0,a.jsx)(o.Wu,{children:(0,a.jsx)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:(0,a.jsx)("p",{className:"text-yellow-700",children:"Unable to load participant data. Please try again later."})})})]})})})]}):(0,a.jsxs)("div",{className:"flex min-h-screen flex-col",children:[(0,a.jsx)(l.Y,{}),(0,a.jsx)("main",{className:"flex-1 container py-12",children:(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center h-[60vh]",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"Please connect your wallet"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Connect your Solana wallet to make a contribution"})]})})]})}},49026:(e,t,r)=>{"use strict";r.d(t,{Fc:()=>o,TN:()=>d,XL:()=>c});var i=r(95155),n=r(12115),a=r(74466),s=r(53999);let l=(0,a.F)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),o=n.forwardRef((e,t)=>{let{className:r,variant:n,...a}=e;return(0,i.jsx)("div",{ref:t,role:"alert",className:(0,s.cn)(l({variant:n}),r),...a})});o.displayName="Alert";let c=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,i.jsx)("h5",{ref:t,className:(0,s.cn)("mb-1 font-medium leading-none tracking-tight",r),...n})});c.displayName="AlertTitle";let d=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,i.jsx)("div",{ref:t,className:(0,s.cn)("text-sm [&_p]:leading-relaxed",r),...n})});d.displayName="AlertDescription"},53211:(e,t,r)=>{Promise.resolve().then(r.bind(r,46565))},63655:(e,t,r)=>{"use strict";r.d(t,{hO:()=>o,sG:()=>l});var i=r(12115),n=r(47650),a=r(99708),s=r(95155),l=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"].reduce((e,t)=>{let r=i.forwardRef((e,r)=>{let{asChild:i,...n}=e,l=i?a.DX:t;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,s.jsx)(l,{...n,ref:r})});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{});function o(e,t){e&&n.flushSync(()=>e.dispatchEvent(t))}},82714:(e,t,r)=>{"use strict";r.d(t,{J:()=>c});var i=r(95155),n=r(12115),a=r(40968),s=r(74466),l=r(53999);let o=(0,s.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),c=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,i.jsx)(a.b,{ref:t,className:(0,l.cn)(o(),r),...n})});c.displayName=a.b.displayName},85339:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});let i=(0,r(19946).A)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},88482:(e,t,r)=>{"use strict";r.d(t,{BT:()=>c,Wu:()=>d,ZB:()=>o,Zp:()=>s,aR:()=>l,wL:()=>u});var i=r(95155),n=r(12115),a=r(53999);let s=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,i.jsx)("div",{ref:t,className:(0,a.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",r),...n})});s.displayName="Card";let l=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,i.jsx)("div",{ref:t,className:(0,a.cn)("flex flex-col space-y-1.5 p-6",r),...n})});l.displayName="CardHeader";let o=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,i.jsx)("div",{ref:t,className:(0,a.cn)("text-2xl font-semibold leading-none tracking-tight",r),...n})});o.displayName="CardTitle";let c=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,i.jsx)("div",{ref:t,className:(0,a.cn)("text-sm text-muted-foreground",r),...n})});c.displayName="CardDescription";let d=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,i.jsx)("div",{ref:t,className:(0,a.cn)("p-6 pt-0",r),...n})});d.displayName="CardContent";let u=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,i.jsx)("div",{ref:t,className:(0,a.cn)("flex items-center p-6 pt-0",r),...n})});u.displayName="CardFooter"},89852:(e,t,r)=>{"use strict";r.d(t,{p:()=>s});var i=r(95155),n=r(12115),a=r(53999);let s=n.forwardRef((e,t)=>{let{className:r,type:n,...s}=e;return(0,i.jsx)("input",{type:n,className:(0,a.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",r),ref:t,...s})});s.displayName="Input"}},e=>{var t=t=>e(e.s=t);e.O(0,[956,867,33,416,568,435,973,441,684,358],()=>t(53211)),_N_E=e.O()}]);